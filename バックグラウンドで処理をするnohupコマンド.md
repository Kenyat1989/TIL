#バックグラウンドで処理をするnohupコマンド

ジョブを`kill`されないようにするには`nohup`コマンドを使います。

`nohup`コマンドでバックグラウンドで走らせたいバッチ処理プログラムなどを実行すればログアウトしても`kill`されないのでプロセスは継続しますから心置きなく家へ帰れます。`nohup`コマンドは Linux以外にもUnix系のOSなら使えるでしょう。

##使い方
###普通に使う
```bash
$ nohup ./abc.sh &
```
abc.sh の標準出力、標準エラー出力に送られたデータはプログラムを実行したディレクトリに nohup.out というファイル名で保存される。プログラムを実行したディレクトリに書き込み権限が無ければ `$HOME/nohup.out`に保存される。

###標準出力先を指定する
```bash
$ nohup ./abc.sh > out.log &
```

`abc.sh`の標準出力が`out.log`になる。標準エラー出力は`nohup.out`で保存先は例１と同様にプログラムを実行したディレクトリか`$HOME`になる。

###標準エラー出力先を指定する
```bash
$ nohup ./abc.sh > out.log 2> err.log &
```

`abc.sh`の標準出力が`out.log`になる。標準エラー出力は`err.log`です。

以上のようなコマンドを実行した後はログアウトして大丈夫です。心配なら再度ログインしてプロセスを確認してみましょう。

##注意点
###標準入力を閉じる
SSHでログインしている場合は3つのI/Oストリームをリダイレクトしておきます。SSH接続でバックグラウドジョブを実行する場合、日常的に標準出力、標準エラー出力をリダイレクトしていると思いますがここで重要なのは標準入力を閉じておくことです。具体的には`/dev/null`にします。

```bash
$ nohup ./abc.sh > out.log 2> err.log < /dev/null &
```

###バックグラウンドジョブとして実行する
もうひとつ、`nohup`は実行したプログラムを自動的にバックグラウンドジョブにするものではありません。バックグラウンドで実行するなら`&`を付けて実行するか`bg`コマンドを使いましょう。

###実行中のプログラムを終了する
`nohup`で実行中のプログラムを終了させるにはプロセスIDを調べて`kill`コマンドで強制終了(`kill -KILL`)します。

###参考
[http://www.codereading.com/nb/ignore-the-hangup-signal.html](http://www.codereading.com/nb/ignore-the-hangup-signal.html)